<!DOCTYPE html>
<html>
    <link rel="stylesheet" type="text/css" href="style-note.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title> Gradient descent </title>

    <body>

      	<div class='note'>
            <div class='img' id='img-gaussian-deterministic'> </div>
            <h1> The basics </h1>
            <p>
            A Gaussian process is a stochastic process (collection of random variables)
            such that every finite collection of those random variables has a multivariate
            normal distribution. The distribution generated by a Gaussian process is
            the joint distribution of all those (infinitely many) random variables.
            </p>
            <div class='mark'>
                The Gaussian process may be fully specified as \(N ( E(x), k(x,x) )\),
                where E(x) is the expected value as a function of x and k is the
                covariance matrix (or kernel) at x.
            </div>
            <p>
    	    A typical kernel selection can be:
    	    \[ k(x_i, x_j) = \sigma_f^2 e^{-\frac{1}{2 l^2}||x_i,x_j||_2^2} \]
    	    The parameter \(\sigma_f\) affects vertical variation of the function,
            while \(l\) affects the smoothness of the function. In higher dimensions
            (forecast dependent on more than one variable) it would be possible to
            select different weights \(l\) for each feature. Note that there is a
            requirement for the kernel to be symmetric and positive-definite.<br><br>

    	    The mean is typically set to zero, as an appropriatelly selected kernel
            can capture any relevant characteristics as well.<br><br>

    	    Assuming some points relating to the function are known (the training set)
            and predictions are required at a given point then:
    	    \[ p(y_f, y_0) = \mathcal{N}
    	    (\begin{bmatrix} m_f \\ m_0 \end{bmatrix},
    	    \begin{bmatrix} k(x_f,x_f) & k(x_f,x_0) \\ k(x_0,x_f)^T & k(x_0,x_0) \end{bmatrix} ) \]
    	    \[ p(y_f | y_0) = \mathcal{N} ( m_f + k(x_f,x_0) \cdot k(x_0,x_0)^{-1}
            \cdot (y_0-m_0) , k(x_f,x_f) - k(x_f,x_0) \cdot k(x_0,x_0)^{-1} \cdot k(x_f,x_0)^T ) \]

    	    The parameters should be selected so that they maximize the likelihood
            that \(x_0,y_0\) are derived from the given gaussian process. This is
            equivalent to maximizing the log likelihood, which is defined as:
    	    \[log p(f|x) = -0.5 y_0^T (K + \sigma_n^2 I) y_0 - 0.5 log|K+\sigma_n^2 I| - 0.5nlog2\pi \]
    	    Where \(n\) is the number of points.<br><br>

    	    For a limited amount of data the challenge is to identify the most
            relevant kernel and fit its parameters to the data. For larger data
            sets, the inversion of the data matrix required for the prediction
            can make things computationally intractable.<br>
    	    One possible solution is using a smaller pseudo-data set produced by
            the training data-set, which would still provide sufficient information
            for the gaussian process to fit the data sufficiently well.<br>
            Taking this idea a step further, the stochastic variational inference
            approach approximates the original dataset via a smaller set of points
            \((u,z)\) which is optimised along with the kernel parameters.<br><br>

            Finally, to approximate data outside range covered by available samples a
            prerequisite is to make certain assumptions regarding the form of the
            function. The gaussian process with the standard quadratic exponential
            kernel will typically revert to a zero mean normally distributed prediction
            when trying to predict a value for from previous datapoints. This can be avoided
            by combining different kernels.
            </p>
	    </div>


	    <script>

          xa = [-1.5,-1.46,-1.42,-1.38,-1.34,-1.3,-1.26,-1.22,-1.18,-1.14,-1.1,
                -1.06,-1.02,-0.98,-0.94,-0.9,-0.86,-0.82,-0.78,-0.74,-0.7,-0.66,
                -0.62,-0.58,-0.54,-0.5,-0.46,-0.42,-0.38,-0.34,-0.3,-0.26,-0.22,
                -0.18,-0.14,-0.1,-0.06,-0.02,0.02,0.06,0.1,0.14,0.18,0.22,0.26,
                0.3,0.34,0.38,0.42,0.46,0.5,0.54,0.58,0.62,0.66,0.7,0.74,0.78,0.82,
                0.86,0.9,0.94,0.98,1.02,1.06,1.1,1.14,1.18,1.22,1.26,1.3,1.34,
                1.38,1.42,1.46,]
          ya = [-0.62,-0.75,-0.59,-0.11,0.49,0.91,0.98,0.76,0.45,0.22,0.08,0.02,
                -0.01,-0.04,-0.12,-0.26,-0.45,-0.62,-0.66,-0.52,-0.29,-0.10,0.08,
                0.41,0.98,1.50,1.51,0.84,-0.09,-0.75,-0.89,-0.68,-0.40,-0.21,
                -0.13,-0.07,0.08,0.39,0.74,0.93,0.91,0.81,0.75,0.67,0.53,0.40,
                0.29,0.04,-0.41,-0.90,-1.13,-1.02,-0.76,-0.58,-0.58,-0.64,-0.53,
                -0.10,0.55,1.07,1.14,0.76,0.12,-0.49,-0.89,-0.99,-0.84,-0.58,
                -0.32,-0.14,-0.02,0.09,0.28,0.57,0.96]
         yL = [-1.65,-1.16,-0.62,-0.13,0.47,0.87,0.55,-0.28,-1.00,-1.41,-1.58,
               -1.65,-1.68,-1.71,-1.73,-1.68,-1.41,-0.98,-0.69,-0.52,-0.29,-0.10,
               0.07,0.41,0.98,1.50,1.50,0.84,-0.09,-0.76,-1.06,-1.31,-1.59,-1.72,
               -1.64,-1.28,-0.57,0.22,0.73,0.93,0.91,0.81,0.74,0.67,0.53,0.37,
               0.22,0.03,-0.41,-0.90,-1.32,-1.74,-2.02,-2.07,-1.92,-1.49,-0.81,
               -0.12,0.55,1.04,0.86,-0.01,-0.84,-1.09,-0.99,-1.05,-1.40,-1.73,
               -1.83,-1.77,-1.68,-1.57,-1.34,-0.85,-0.01]
         yH = [0.40,-0.33,-0.56,-0.09,0.51,0.95,1.40,1.79,1.91,1.84,1.74,1.69,
               1.66,1.62,1.49,1.16,0.51,-0.26,-0.62,-0.51,-0.29,-0.09,0.09,0.41,
               0.98,1.50,1.51,0.85,-0.09,-0.74,-0.72,-0.05,0.80,1.30,1.39,1.14,
               0.73,0.55,0.74,0.94,0.91,0.81,0.75,0.67,0.53,0.44,0.36,0.06,-0.41,
               -0.89,-0.93,-0.30,0.50,0.91,0.77,0.22,-0.25,-0.08,0.55,1.09,
               1.43,1.53,1.08,0.11,-0.78,-0.93,-0.29,0.58,1.19,1.50,1.65,1.75,
               1.89,2.00,1.94]
          x = [-0.38,-1.32,0.41,-0.52,1.08,-0.68,0.11,-0.50,-0.76,0.80,0.11,
               -0.56,0.19,0.44,0.84,0.03,-1.40,-0.37,1.54,0.25]
          y = [-0.10,0.74,-0.32,1.24,-0.98,-0.21,0.88,1.53,-0.59,0.25,0.89,0.69,
               0.73,-0.68,0.80,0.83,-0.40,-0.23,1.49,0.57]

          FIG1 = document.getElementById('img-gaussian-deterministic');
    			Plotly.newPlot(FIG1,
                         [{x: xa, y: yL,
                          name: 'gaussian (low)',
                          line: {color: 'lightgreen'}},
                          {x: xa, y: yH,
                           name: 'gaussian (high)',
                           line: {color: 'lightgreen'},
                           fill: 'tonexty'},
                          {x: xa, y: ya,
                           name: 'gaussian (average)',
                           line: {color: 'blue'}},
                          {x: x, y: y,
                           name: 'sample data',
                           line: {color: 'black'},
                           mode: 'markers'},
                          ],
                          {margin: { t:50, b:50, l:50, r:10},
                           title: 'Gaussian process example',
                           xaxis: {'title' : 'x', 'range': [-1.5,1.5]},
                           yaxis: {'title' : 'f(x)', 'range': [-2.5, 2]},
                           font: {'size':10}},
                        );

		  </script>

    </body>
</html>
