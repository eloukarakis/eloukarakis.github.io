
<html>
    <link rel="stylesheet" type="text/css" href="style-note.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
	<script id="MathJax-script" async
	        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <title> Frequency response fundamentals </title>

    <body>

      	<div class='note'>
	        <h2> What is frequency response </h2>
	        An electrical power system may consist of a huge variety of devices
            - including large conventional generators (gas, diesel),
            wind turbines, demand in various forms (household, industrial)
            and the circuits connecting all these together. The system itself is designed to operate within specific voltage limits,
            specified in terms of voltage amplitude and frequency. When the system is subjected to a disturbance -
            typically the loss or addition of a device - the voltage fluctuates. <br>
            <div class='mark'>
                Frequency response refers to how voltage frequency changes over time, particularly after a contingency (e.g. generating plant outage).
            </div>
	    </div>

	    <div class='note'>
	        <h2> What is involved </h2>

	        Conventional generators consist of: 1) a prime mover - that's the gas turbine or diesel engine that burns fuel to move the generator;
            2) a prime mover control system - an electromechanical system that controls the flow of fuel; 3) an electrical generator -
            which is a combination of electrical circuits and rotating parts; 4) generator control systems -
            including a frequency control system controlling the generator rotating speed, the excitation system controlling
            the voltage amplitude and several protection systems which set the generator offline if it is detected to operate outside allowable limits. <br><br>

	        The electrical generator is typically of the synchronous type, which means that its voltage output
            has a frequency proportional to its rotating speed (rotation is a prerequisite to generating power).
            Under normal circumstances, the power generated by fuel burned by the generator is equal to the power consumed
            in the network and the generator rotates at a constant speed which results in a voltage frequency of 50Hz
            (or 60Hz depending on the country). When the power consumed by the network is more than the power generated,
            the generator looses kinetic energy (hence frequency drops) and vice-versa. While detailed simulations would
            be required to accurately capture frequency response dynamics, it is possible to capture the basic
            frequency response characteristics through a simplified set of equations.<br><br>

	    </div>

	    <div class='note'>

	        <h2> The basic equations </h2>

			The first of these equations is one describing the generator's motion:
	        \[J\frac{d\omega_m}{dt} = T_m - T_e\]
	        Where \(J\) is the generator inertia in kg.m<sup>2</sup>, \(\omega_m\)
            is the (electrical) rotational speed in rad/sec, and \(T_e,T_m\)
            the electrical and mechanical torque in N.m respectively. Assuming \(\omega_b\)
            is the speed which corresponds to 50Hz, and considering that deviations from that reference frequency are small we may write:
	        \[J\frac{d\omega_m}{dt} = T_m - T_e
	        \rightarrow J \omega_b^2 \frac{\omega_m}{\omega_b} \frac{d\omega_m}{\omega_b dt} = P_m - P_e
	        \rightarrow \frac{H}{2} \frac{d\omega}{dt} = P_m - P_e\]
	        Where \(H\) is the generator inertia in seconds, \(\omega\) is the per unit (of nominal) rotating speed
            and subsequently grid frequency (it is equal to 1 when the grid frequency is at 50Hz), and \(P_m,P_e\)
            are the mechanical and electrical power to/from the generator.<br>

	        Depending on the type of generator (diesel, steam, hydro, etc.) there is a wide variety
            of systems that convert fuel into power that moves the generator. In the simplest case
            associated systems (which applies to diesel engines or non-reheat steam turbines) the associated system may be represented through two equations:
	        \[T_g \frac{dP_t}{dt} + P_t = P_{ref}\]
			\[T_t \frac{dP_m}{dt} + P_m = P_t\]
			Where \(T_g\) is the time-constant associated with the governor / control-system, \(T_t\)
            is the time-constant associated with the prime mover, and \(T_{ref}\) is the desired power output from the generator.<br>

	        Generators typically operate in any of either modes: 1) at a fixed \(P_{ref}\) set-point
            (typically fully loaded generators that do not contribute directly to frequency response);
            2) using a 'droop' control the increases/decreases output power in proportion to frequency deviations (partially loaded generators that contributed to frequency response), i.e.:
	        \[P_{ref} = - \frac{1}{R}(\omega-1)\]
	        Where \(R\) is a constant number (called the droop-setting).
            This proportional control scheme enables us to know for any given frequency deviation, how power is shared among connected generators. <br><br>
	        A smaller number of generators may have a slower control system that tries
            to get any frequency error back to zero. This is to avoid oscillations among different generators competing to restore the frequency.
	    </div>

	    <div class='note'>
	    	<div class='img' id='img-typical-response'> </div>

	    	<h2> Typical frequency response </h2>
	    	Consider a system where the generation and demand are in balance, equal to each other, when suddenly one generator is lost.
            Using the equations above we can calculate the frequency response trajectory as seen on the figure.<br>
            - At 1sec the generator is lost and demand is more than the energy produced by fuel burnt by the generators.
            The demand has to be met however and that can only happen by taking the kinetic energy in the rotating generators.
            As the generators slow down, system frequency starts to drop. The initial rate of change of frequency depends largely
            on how large the mismatch between generation and demand is, as well as the inertia of the generators remaining connected in the system.<br>
            - As the generator control systems register this frequency deviation, their governors inject more fuel/steam in the engine/turbine,
            generation increases until the frequency drop stops at about 3sec. The faster the governors and turbines, the more limited this frequency drop would be.
            Due to delays introduced by the governor/prime-mover frequency drops below what would be expected based on the droop control characteristic. <br>
            - Gradually the frequency stabilises at a level that's based on the droop control settings. The oscillations in between are due to the
            interactions between various mechanical components and their control systems.<br><br>

	    	If frequency were to deviate outside the operating range of any generators, these would start to disconnect.
            This is because turbines are designed to operate optimally at a predetermined rotation speed.
            Deviating much from it may lead to damage to the turbine blades due to vibrations. Loss of several generators
            would eventually lead to a blackout. To prevent this, under-frequency protection may trip demand when either of low value or high rate of change of frequency is detected.<br><br>

	    	In practice demand and generation (especially from renewables) constantly change, with the large generators
            trying to catch up. As a consequence the frequency constantly oscillates around 50Hz. More often than not,
            the imbalance / mismatch between demand and generation is small and the frequency deviations are quite limited.

            <div class='mark'>
                This typical response implies that a system operator should ensure that
                at any given time the system has a sufficient combination of inertia and generator response
                capability to avoid demand disconnections for expected outages.
            </div>
	    </div>

	    <div class='note'>
	        <h2> Useful references </h2>
	        <ul class='lit'>
	          <li> P. Kundur (1994). <u>Power System Stability and Control</u>. McGraw-Hill.</li>
	        </ul>
	    </div>



		<script>

            function figure_typical_response(allRows) {

                console.log(allRows);
                var x = [], y = [], standard_deviation = [];

                for (var i=0; i<allRows.length; i++) {
                    row = allRows[i];
                    x.push( row['t'] );
                    y.push( row['f'] );
                }
                console.log( 'X',x, 'Y',y, 'SD',standard_deviation );

                FIG1 = document.getElementById('img-typical-response');
    			Plotly.newPlot( FIG1,
                                [{x: x, y: y }],
                                {
                                    margin: { t:50, b:50, l:50, r:10},
                                    title: 'Typical frequency response',
                                    xaxis: {'title' : 'time [sec]'},
                                    yaxis: {'title' : 'frequency [Hz]'},
                                    font: {'size':10}
                                },
                            );
            }

            Plotly.d3.csv('https://eloukarakis.github.io/data/design-typical-frequency-response.csv',
                           function(data){ figure_typical_response(data) } );


		</script>

    </body>
</html>
